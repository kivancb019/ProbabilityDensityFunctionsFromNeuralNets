<html>


    
    <head>
        <title>Generate Furnace Heat Images per Conditions</title>
        <meta charset="utf-8" />
        <link rel="icon" type="image/x-icon" href="./favicon.png" />
        <link
            rel="stylesheet"
            href="https://pyscript.net/latest/pyscript.css"
        />
        <script defer src="https://pyscript.net/latest/pyscript.js"></script>
        <link rel="stylesheet" href="./assets/css/examples.css" />
    </head>



    
    <body>

        
        <nav class="navbar" style="background-color: #000000">
            <div class="app-header">
                <a href="/">
                    <img src="./logo.png" class="logo" />
                </a>
                <a class="title" href="" style="color: #f0ab3c">KNN avg Generator</a>
            </div>
        </nav>

      
        <div>Type conditions here: </div>
   
 <table>
 
  <tr>
     <td> Ng </td>
     <td> <input type="text" style="border:3px solid #F7730E;" value="0" id="testInput1"/> </td>

       <td> Pci </td>
     <td>   <input type="text" style="border:3px solid #F7730E;" value="175" id="testInput2"/> </td>

       <td> H </td>
     <td>  <input type="text" style="border:3px solid #F7730E;" value="0" id="testInput3"/> </td>

       <td> Wp </td>
     <td>   <input type="text" style="border:3px solid #F7730E;" value="0" id="testInput4"/> </td>

       <td> Ph</td>
     <td>       <input type="text" style="border:3px solid #F7730E;" value="300" id="testInput5"/>  </td>
  </tr>
        
       
  <tr>
     <td> Ox </td>
     <td>  <input type="text" style="border:3px solid #F7730E;" value="24" id="testInput6"/> </td>

     <td>Ow</td>
     <td>    <input type="text" style="border:3px solid #F7730E;" value="7" id="testInput7"/> </td>

     <td> Hbt</td>
     <td>     <input type="text" style="border:3px solid #F7730E;" value="1459" id="testInput8"/> </td>

     <td> Wm</td>
     <td>  <input type="text" style="border:3px solid #F7730E;" value="12" id="testInput9"/> </td>

    <td> Wr</td>
     <td>     <input type="text" style="border:3px solid #F7730E;" value="308750" id="testInput10"/>  </td>
  </tr> 
 
 </table> 

       
         <button id="get-time" py-click="my_gen_function()"  class="py-button">Call Function</button>
                                       
       
        <p id="current-val"></p>
  
        <div id="test-output"></div>



        <section class="pyscript">
            <div id="mpl"></div>

    


                
                <py-config>
                    packages = [
                      "matplotlib",
                      "pandas",
                    ]
                    plugins = [
                      "https://pyscript.net/latest/plugins/python/py_tutor.py"
                    ]
                </py-config>


                

                <script type="py">

                    
                    import matplotlib.pyplot as plt
                    import matplotlib.tri as tri
                    import numpy as np
                    import pandas as pd
                    from pyodide.http import open_url
                    from js import console

                     ###########################################

                   

                    def my_gen_function5(*args, **kwargs):
                        #print('args:', args)
                        #print('kwargs:', kwargs)
                        console.log(f'args: {args}')
                        console.log(f'kwargs: {kwargs}')
                        text = Element('testInput1').element.value
                        #print('text:', text)
                        console.log(f'text: {text}')
                        #Element('test-output').element.innerText = text
                        pyscript.write('test-output', text)

                    ###########################################


                    url1 = ("https://rcalix1.github.io/ProbabilityDensityFunctionsFromNeuralNets/experiments/2023/july2023/GANs/PyScriptExamples/example3/PD_ids_train.csv")
                    pd_ids_train = pd.read_csv(open_url(url1))
                    pd_ids_train_np = pd_ids_train.to_numpy()

                    url2 = ("https://rcalix1.github.io/ProbabilityDensityFunctionsFromNeuralNets/experiments/2023/july2023/GANs/PyScriptExamples/example3/PD_conditions_train.csv")
                    pd_conditions_train = pd.read_csv(open_url(url2))
                    pd_conditions_train_np = pd_conditions_train.to_numpy()

                    url3 = ("https://rcalix1.github.io/ProbabilityDensityFunctionsFromNeuralNets/experiments/2023/july2023/GANs/PyScriptExamples/example3/PD_imgs_np_train.csv")
                    pd_imgs_np_train = pd.read_csv(open_url(url3))
                    pd_imgs_np_train_np = pd_imgs_np_train.to_numpy()
                    

                    ######################################################

                    def euclidean_distance(v1, v2):
                        return np.sqrt( np.sum(   (v1 - v2)**2   )   )

                    ######################################################

                    def predict(test_x):
                        distances = [ euclidean_distance(test_x, x )  for x in conditions_matrix_train   ]
                        k = 3
                        k_neighbor_indices = np.argsort(distances)[:k]
                        print(k_neighbor_indices)
                        img_names = [ list_ids_train[i]  for i in k_neighbor_indices  ]
                        return img_names

                    ################################################

                    def generate_img_per_index(index):
                        res = predict( conditions_matrix_test[  index  ] ) 
                        selected_imgs_to_avg = []
                        for img_name in res:
                            img_name = img_name
                            my_img = Image.open(img_name)
                            selected_imgs_to_avg.append(img_np)
                            avg_gen_img = np.mean( np.array(selected_imgs_to_avg), axis=0 )
                            gen_pil_image  = Image.fromarray(avg_gen_img).convert('L')
                            return gen_pil_image

                    ##################################################

                     def my_gen_function3():
                        text = Element('testInput1').element.value
                        Element('test-output').element.innerText = text

                    ##################################################

                     def my_gen_function():
                        text = str(pd_conditions_train_np.shape)
                        console.log(f'text: {text}')
                        ## text = Element('testInput1').element.value
                        Element('test-output').element.innerText = "ufo"


                    ###########################################

                    # First create the x and y coordinates of the points.
                    n_angles = 36
                    n_radii = 8
                    min_radius = 0.25
                    radii = np.linspace(min_radius, 0.95, n_radii)

                    angles = np.linspace(0, 2 * np.pi, n_angles, endpoint=False)
                    angles = np.repeat(angles[..., np.newaxis], n_radii, axis=1)
                    angles[:, 1::2] += np.pi / n_angles

                    x = (radii * np.cos(angles)).flatten()
                    y = (radii * np.sin(angles)).flatten()
                    z = (np.cos(radii) * np.cos(3 * angles)).flatten()

                    # Create the Triangulation; no triangles so Delaunay triangulation created.
                    triang = tri.Triangulation(x, y)

                    # Mask off unwanted triangles.
                    triang.set_mask(np.hypot(x[triang.triangles].mean(axis=1),
                                             y[triang.triangles].mean(axis=1))
                                    < min_radius)

                    fig1, ax1 = plt.subplots()
                    ax1.set_aspect('equal')
                    tpc = ax1.tripcolor(triang, z, shading='flat')
                    fig1.colorbar(tpc)
                    ax1.set_title('tripcolor of Delaunay triangulation, flat shading')

                    display(fig1, target="mpl")


                    
                </script>
         
        </section>


        
    </body>
</html>

